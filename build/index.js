(()=>{"use strict";const e=window.wp.plugins,t=window.wp.compose,o=window.wp.data,n=window.React,s=window.wp.editor,i=window.wp.element,r=window.wp.components,a=window.wp.i18n,c=(0,t.compose)([(0,o.withSelect)((e=>{const{getCurrentPostId:t,getCurrentPostAttribute:o}=e("core/editor"),n=o("meta");return{postId:t(),meta:n}})),(0,o.withDispatch)((e=>({savePostMeta(t){e("core/editor").editPost({meta:t})},saveDocument(){e("core/editor").savePost()}})))])((({postId:e,meta:t,savePostMeta:c,saveDocument:l})=>{var d,p,u,w,v;let m=(0,o.select)("core/editor").getCurrentPostType(),h=window.AcjIeBlocksEditorSettings.settings;const{wpSettings:f}=h;if(-1===f.allowed_post_types.indexOf(m))return;const[y,_]=(0,i.useState)(!1);"post"===m&&(m="posts");const[g,S]=(0,i.useState)(null!==(d="true"===t.speechify_enable_conversion)&&void 0!==d&&d),[b,E]=(0,i.useState)(null!==(p=t.speechify_conversion_id)&&void 0!==p?p:0),[P,C]=(0,i.useState)(null!==(u=t.speechify_conversion_link)&&void 0!==u?u:""),[k,A]=(0,i.useState)(null!==(w=t.speechify_conversion_audio)&&void 0!==w?w:""),[j,D]=(0,i.useState)(null!==(v=t.speechify_conversion_format)&&void 0!==v?v:"mp3"),[x,B]=(0,i.useState)(t.speechify_conversion_done);return(0,i.useEffect)((()=>{if(k){let e=((e,t)=>{let o=function(e){return{mp3:"audio/mpeg",aac:"audio/aac",wav:"audio/wav",ogg:"audio/ogg"}[e.toLowerCase()]||null}(t);if(!o)return void console.error("Unsupported audio format:",t);let n=((e,t)=>{let o=atob(e),n=new Array(o.length);for(let e=0;e<o.length;e++)n[e]=o.charCodeAt(e);let s=new Uint8Array(n);return new Blob([s],{type:t})})(e,o);return URL.createObjectURL(n)})(k,j);C(e)}}),[]),(0,n.createElement)(s.PluginDocumentSettingPanel,{name:`speechify-${m}-panel`,title:"Speechify",className:`speechify-${m}-panel`},g&&""===x&&(0,n.createElement)("div",null,(0,a.__)("Conversions Enabled, Please save the Document to start processing.","acjpd-text-to-speech-speechify")),g&&"false"===x&&(0,n.createElement)("div",{style:{color:"red"}},(0,a.__)("Conversion failed, please check Api key.","acjpd-text-to-speech-speechify"),(0,n.createElement)(r.Button,{variant:"secondary",onClick:()=>(B(""),S(!0),void c({speechify_enable_conversion:"true",speechify_conversion_done:""}))},"Reset")),g&&b&&P&&"true"===x&&(0,n.createElement)("div",{id:"audio-container"},(0,n.createElement)("audio",{controls:!0},(0,n.createElement)("source",{src:P,type:"audio/mpeg"}),"Your browser does not support the audio element.")),!g&&(0,n.createElement)(r.Button,{disabled:y,onClick:async()=>{_(!0),c({speechify_enable_conversion:"true"}),S(!0),_(!1)},variant:"secondary"},"Convert to Speech"))}));(0,e.registerPlugin)("acjpd-text-to-speech-speechify-sidebar-panel",{render:c,icon:"palmtree"})})();